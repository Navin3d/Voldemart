package gmc.project.voldemart.bootstrap;

import gmc.project.voldemart.domain.Authorities;
import gmc.project.voldemart.domain.Roles;
import gmc.project.voldemart.domain.User;
import gmc.project.voldemart.repositoies.UserRepository;
import gmc.project.voldemart.repositoies.AuthoritiesRepository;
import org.springframework.context.ApplicationListener;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.stereotype.Component;

import java.util.ArrayList;
import java.util.List;

@Component
public class UserBootstrap implements ApplicationListener<ContextRefreshedEvent> {

    private final UserRepository userRepository;
    private final AuthoritiesRepository authoritiesRepository;

    public UserBootstrap(UserRepository userRepository, AuthoritiesRepository authoritiesRepository) {
        this.userRepository = userRepository;
        this.authoritiesRepository = authoritiesRepository;
    }

    public List<User> getUsers() {
        List<User> userList = new ArrayList<>();

        User user1 = new User();
        user1.setFirstName("C H");
        user1.setLastName("Parithran Reddy");
        user1.setUserName("reddy");
        user1.setPassword("{noop}reddy");
//        user1.setAddress("FLAT NO 102, SRI SUPRAJA PARADISE  (APT), MAIN ROAD ,KOVUR, NELLORE DISTRICT.");
//        user1.setZipCode(524137);
        user1.setPhoneNumber("+918099992979");
        userList.add(user1);

        User user2 = new User();
        user2.setFirstName("S M");
        user2.setLastName("Logasubramani");
        user2.setUserName("loga");
        user2.setPassword("{noop}loga");
//        user2.setAddress("No 3/788 Karpagambal nagar Madhanadhapuram porur Chennai");
//        user2.setZipCode(600116);
        user2.setPhoneNumber("+919790778113");
        userList.add(user2);
        
        User user3 = new User();
        user3.setUserName("Navin");
        user3.setPassword("{noop}navin@3d");

        userArrayList.add(user3);

        return userList;
    }

    public ArrayList<Authorities> getAuthorities() {

        ArrayList<Authorities> authoritiesList = new ArrayList<>();

        Authorities authorities = new Authorities();
        authorities.setUserName("reddy");
        authorities.setAuthority(Roles.USER);
        authoritiesList.add(authorities);

        Authorities authorities1 = new Authorities();
        authorities1.setUserName("loga");
        authorities1.setAuthority(Roles.USER);
        authoritiesList.add(authorities1);

        return authoritiesList;
    }

    @Override
    public void onApplicationEvent(ContextRefreshedEvent event) {
        userRepository.saveAll(getUsers());
        authoritiesRepository.saveAll(getAuthorities());
    }
}
