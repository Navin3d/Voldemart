package gmc.project.voldemart.bootstrap;

import gmc.project.voldemart.domain.Authorities;
import gmc.project.voldemart.domain.User;
import gmc.project.voldemart.domain.Roles;
import gmc.project.voldemart.repositoies.AuthoritiesRepository;
import gmc.project.voldemart.repositoies.UserRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationListener;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.stereotype.Component;

import java.util.ArrayList;

@Component
public class AuthoritiesBootstrap implements ApplicationListener<ContextRefreshedEvent> {

    @Autowired
    private AuthoritiesRepository authoritiesRepository;
    @Autowired
    private UserRepository userRepository;

    public ArrayList<User> getUser() {
        ArrayList<User> userArrayList = new ArrayList<>();

        User user1 = new User();
        user1.setUserName("Navin");
        user1.setPassword("{noop}navin@3d");

        userArrayList.add(user1);

        return userArrayList;
    }

    public ArrayList<Authorities> getAuthorities() {
        ArrayList<Authorities> arrayList = new ArrayList<>();
        Authorities authorities = new Authorities();
        authorities.setUserName("Navin");
        authorities.setAuthority(Roles.ADMIN);
        arrayList.add(authorities);
        
        ArrayList<Authorities> authoritiesList = new ArrayList<>();

        Authorities authorities1 = new Authorities();
        authorities1.setUserName("reddy");
        authorities1.setAuthority(Roles.USER);
        authoritiesList.add(authorities1);

        Authorities authorities2 = new Authorities();
        authorities2.setUserName("loga");
        authorities2.setAuthority(Roles.USER);
        authoritiesList.add(authorities2);
        
        return arrayList;
    }

    @Override
    public void onApplicationEvent(ContextRefreshedEvent event) {

        authoritiesRepository.saveAll(getAuthorities());
        userRepository.saveAll(getUser());

    }
}
